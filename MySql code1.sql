CREATE DATABASE ENVIRONMENTAL_MONITORING;
USE ENVIRONMENTAL_MONITORING;

CREATE TABLE REGULATORY_BODY(
REGULATORY_BODY_ID INT PRIMARY KEY,
REGULATORY_BODY_NAME VARCHAR(150),
LOCATION VARCHAR(150),
REGULATORY_BODY_TYPE VARCHAR(150)
);

CREATE TABLE INSPECTOR(
  INSPECTOR_ID INT PRIMARY KEY, 
  INSPECTOR_NAME VARCHAR(150), 
  INSPECTOR_RANK VARCHAR(150)
);

CREATE TABLE INDUSTRY(
  INDUSTRY_ID INT PRIMARY KEY, 
  INDUSTRY_NAME VARCHAR(150), 
  INDUSTRY_TYPE VARCHAR(150), 
  PRODUCTS VARCHAR(150)
);

CREATE TABLE ENVIRONMENTAL_PERMIT(
  PERMIT_ID INT PRIMARY KEY, 
  ISSUE_DATE DATE, 
  EXPIRY_DATE DATE, 
  ISSUED_BY INT, 
  INDUSTRY_ID INT, 
  FOREIGN KEY (INDUSTRY_ID) REFERENCES INDUSTRY(INDUSTRY_ID),
  FOREIGN KEY (ISSUED_BY) REFERENCES REGULATORY_BODY(REGULATORY_BODY_ID)
);

CREATE TABLE PERMIT_APPLICATION(
  APPLICATION_ID INT PRIMARY KEY, 
  PERMIT_TYPE VARCHAR(150), 
  APPLICATION_DATE DATE, 
  PERMIT_STATUS VARCHAR(150)
);

CREATE TABLE INSPECTION_REPORT(
  REPORT_ID INT PRIMARY KEY, 
  REPORT_DATE DATE, 
  REPORT_TYPE VARCHAR(150), 
  INDUSTRY_ID INT, 
  FOREIGN KEY (INDUSTRY_ID) REFERENCES INDUSTRY(INDUSTRY_ID)
);

CREATE TABLE MONITORING_STATION(
  STATION_ID INT PRIMARY KEY, 
  STATION_TYPE VARCHAR(150), 
  LOCATION VARCHAR(150), 
  STATION_STATUS VARCHAR(150)
);

CREATE TABLE INDUSTRY_INSPECTION (
  INSPECTOR_ID INT, 
  INDUSTRY_ID INT, 
  INSPECTION_DATE DATE, 
  PURPOSE VARCHAR(150), 
  PRIMARY KEY (INSPECTOR_ID, INDUSTRY_ID, INSPECTION_DATE), 
  FOREIGN KEY (INSPECTOR_ID) REFERENCES INSPECTOR(INSPECTOR_ID), 
  FOREIGN KEY (INDUSTRY_ID) REFERENCES INDUSTRY(INDUSTRY_ID)
);

-- Insert Statements
INSERT INTO REGULATORY_BODY (REGULATORY_BODY_ID, REGULATORY_BODY_NAME, LOCATION, REGULATORY_BODY_TYPE)
VALUES
(10100, 'NAFDAC', 'Isolo, Lagos state', 'Food, Drugs, Health Agency'),
(10101, 'SON', 'Lekki, Lagos state', 'Products, Equipments, Building materials'),
(10102, 'National Oil Spill Detection Agency', 'Surulere, Lagos state', 'Crude Oil, Environmental Pollution Agency'),
(10103, 'National Environmental Standards and Regulatory Enforcement Agency', 'Abuja', 'Environment Control Agency'),
(10104, 'Federal Ministry of Environment', 'Abuja', 'Environmental Policy and Regulation');

INSERT INTO INSPECTOR (INSPECTOR_ID, INSPECTOR_NAME, INSPECTOR_RANK)
VALUES
(10201, 'John Obi', 'Senior Officer'),
(10202, 'Patrick Okoro', 'Field Officer'),
(10203, 'Opeyemi Abdullahi', 'Environment Analyst'),
(10204, 'Bode Thomas', 'Commanding Officer'),
(10205, 'Chika Okafor', 'Junior Officer');

INSERT INTO INDUSTRY (INDUSTRY_ID, INDUSTRY_NAME, INDUSTRY_TYPE, PRODUCTS)
VALUES
(10301, 'GLO', 'Telecommunication Industry', 'Internet services, Call & Messages services'),
(10302, 'EMZOR', 'Manufacturing Industry', 'Drugs, Health services'),
(10303, 'Dangote Cement', 'Manufacturing Industry', 'Cement, Construction Materials'),
(10304, 'ANGELIC CHEMICALS', 'Manufacturing Industry', 'Pesticides, Herbicides, Fertilizers, Petrochemicals'),
(10305, 'Flour Mills of NIGERIA', 'Production Industry', 'Spaghetti, Semovita, Noodles, Rice, Wheat flour, Macaroni');

-- Corrected ENVIRONMENTAL_PERMIT INSERT statement (Removed 10306 as it does not exist)
INSERT INTO ENVIRONMENTAL_PERMIT (PERMIT_ID, ISSUE_DATE, EXPIRY_DATE, ISSUED_BY, INDUSTRY_ID)
VALUES
(10401, '2025-01-01', '2030-01-01', 10103, 10305), -- Updated INDUSTRY_ID to 10305 (Flour Mills of NIGERIA)
(10402, '2024-03-31', '2029-04-01', 10103, 10302),
(10403, '2020-12-31', '2025-12-31', 10101, 10302),
(10404, '2020-01-01', '2025-12-31', 10100, 10305),
(10405, '2024-09-01', '2029-12-31', 10102, 10301);

INSERT INTO PERMIT_APPLICATION (APPLICATION_ID, PERMIT_TYPE, APPLICATION_DATE, PERMIT_STATUS)
VALUES
(10501, 'Radiation Emission', '2024-10-01', 'Approved'),
(10502, 'Environmental Waste Hazards', '2024-01-01', 'Approved'),
(10503, 'Environmental Degradation', '2020-01-01', 'Pending'),
(10504, 'Environment and Noise Pollution', '2019-12-01', 'Pending'),
(10505, 'Air Pollution', '2024-07-31', 'Approved');

INSERT INTO INSPECTION_REPORT (REPORT_ID, REPORT_DATE, REPORT_TYPE, INDUSTRY_ID)
VALUES
(10601, '2025-01-01', 'Radiation Evaluation', 10305), 
(10602, '2024-03-31', 'Environmental inspection', 10302),
(10603, '2020-12-31', 'Environmental inspection', 10302),
(10604, '2020-01-01', 'Environmental inspection', 10305),
(10605, '2024-09-01', 'Environmental inspection', 10301);


INSERT INTO MONITORING_STATION (STATION_ID, STATION_TYPE, LOCATION, STATION_STATUS)
VALUES
(101, 'Water Testing Station', 'Ebutte-Meta, Lagos state', 'Active'),
(102, 'Air Quality Sensor', 'Ojodu-Berger, Lagos state', 'Active'),
(103, 'Soil Profiling Station', 'Agege, Lagos state', 'Defective'),
(104, 'Noise Monitoring Station', 'Lekki, Lagos state', 'Inactive'),
(105, 'Water Quality Monitoring Station', 'Surulere, Lagos state', 'Active');

INSERT INTO INDUSTRY_INSPECTION (INSPECTOR_ID, INDUSTRY_ID, INSPECTION_DATE, PURPOSE)
VALUES
(10201, 10302, '2025-02-01', 'Routine Drug Facility Check'),
(10203, 10305, '2025-03-15', 'Oil Spill Investigation'), 
(10201, 10305, '2025-05-05', 'Safety & Emission Check'), 
(10202, 10304, '2025-07-20', 'Chemical Disposal Inspection'),
(10204, 10301, '2025-08-08', 'Telecom Radiation Test');

SELECT * FROM REGULATORY_BODY;
SELECT * FROM INSPECTOR;
SELECT * FROM INDUSTRY;
SELECT * FROM ENVIRONMENTAL_PERMIT;
SELECT * FROM PERMIT_APPLICATION;
SELECT * FROM INSPECTION_REPORT;
SELECT * FROM MONITORING_STATION;
SELECT * FROM INDUSTRY_INSPECTION;

ALTER TABLE REGULATORY_BODY
ADD COLUMN CAPACITY INT;

SELECT STATION_ID, STATION_TYPE, LOCATION
FROM MONITORING_STATION
WHERE STATION_STATUS = "Active";

SELECT APPLICATION_ID, PERMIT_TYPE, APPLICATION_DATE
FROM PERMIT_APPLICATION
WHERE PERMIT_STATUS = "Pending";

SELECT INDUSTRY_ID, INDUSTRY_NAME, INDUSTRY_TYPE
FROM INDUSTRY;

SELECT STATION_ID, STATION_TYPE, LOCATION
FROM MONITORING_STATION
WHERE STATION_STATUS = "Defective";

ALTER TABLE INSPECTOR
ADD COLUMN EMAIL VARCHAR(150);


SELECT * 
FROM INSPECTION_REPORT i
join INDUSTRY d on d.industry_id = i.industry_id;



SELECT * FROM REGULATORY_BODY; 
